---
title: "Reporte de Análisis de Etanol"
author: "Generado por la Aplicación Shiny"
date: '`r params$fecha`'
output: 
  pdf_document:
    toc: true
    number_sections: true
    fig_caption: yes
params:
  tabla: NULL
  slope: NULL
  df: NULL
  plot_calib: NULL
  plot_cinetica: NULL
  fecha: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.align = "center"
)
library(knitr)
library(ggplot2)
library(kableExtra)  # Asegúrate de cargar kableExtra aquí

if (!is.null(params$tabla)) {
  kable(params$tabla, digits = 3, caption = "Resultados de Concentración de Etanol") %>%
    kable_styling(bootstrap_options = c("striped", "hover"))
} else {
  cat("No hay datos para mostrar en la tabla.")
}
# Verifica que los archivos existan
if (!file.exists(params$plot_calib)) {
  stop("El archivo de la gráfica de calibración no existe.")
}
if (!file.exists(params$plot_cinetica)) {
  stop("El archivo de la gráfica cinética no existe.")
}

# Asegúrate de que sean cadenas de texto
if (!is.character(params$plot_calib) || !is.character(params$plot_cinetica)) {
  stop("Las rutas de las gráficas deben ser cadenas de texto.")
}

# Verifica que los archivos existan antes de incluirlos
if (!is.null(params$plot_calib) && file.exists(params$plot_calib)) {
  knitr::include_graphics(params$plot_calib)
} else {
  cat("No se pudo encontrar la gráfica de calibración.")
}

if (!is.null(params$plot_cinetica) && file.exists(params$plot_cinetica)) {
  knitr::include_graphics(params$plot_cinetica)
} else {
  cat("No se pudo encontrar la gráfica cinética.")
}

cat("## Parámetros Calculados\n\n")
cat(sprintf("- **Slope (Pendiente):** %.4f\n", params$slope))
cat(sprintf("- **Factor de Dilución:** %d\n", params$df))